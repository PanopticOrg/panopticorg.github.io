
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../add/">
      
      
        <link rel="next" href="../list/">
      
      
        
          <link rel="alternate" href="./" hreflang="fr">
        
          <link rel="alternate" href="../../en/plugins/dev/" hreflang="en">
        
      
      
      <link rel="icon" href="../../assets/logo_panoptic_petit.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Créer ses plugins - Panoptic Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#apercu" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../.." title="Panoptic Docs" class="md-header__button md-logo" aria-label="Panoptic Docs" data-md-component="logo">
      
  <img src="../../assets/logo_panoptic_grand.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Panoptic Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Créer ses plugins
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Sélectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../en/plugins/dev/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Partager" aria-label="Partager" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CERES-Sorbonne/Panoptic" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Panoptic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../install/install/" class="md-tabs__link">
          
  
  
    
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../start/first_start/" class="md-tabs__link">
          
  
  
    
  
  Utilisation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../advanced/import/" class="md-tabs__link">
          
  
  
    
  
  Approfondir

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../intro/" class="md-tabs__link">
          
  
  
    
  
  Plugins

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../method/intro/" class="md-tabs__link">
          
  
  
    
  
  Méthodologies proposées

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../compare/intro.md" class="md-tabs__link">
          
  
  
    
  
  Comparaison de modèles

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usecases/bnf/" class="md-tabs__link">
          
  
  
    
  
  Cas d'Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../concepts/" class="md-tabs__link">
        
  
  
    
  
  Glossaire

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../resources/" class="md-tabs__link">
        
  
  
    
  
  Ressources Utiles

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Panoptic Docs" class="md-nav__button md-logo" aria-label="Panoptic Docs" data-md-component="logo">
      
  <img src="../../assets/logo_panoptic_grand.png" alt="logo">

    </a>
    Panoptic Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CERES-Sorbonne/Panoptic" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Panoptic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Installation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation Standard
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/install_plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation Standard - Outils de Similarité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/install_dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation Developpeurs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilisation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilisation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/first_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Premier Lancement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/projets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Créer un projet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/images/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer des Images
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/properties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les Propriétés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/annotate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annoter les Propriétés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/propsimport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer des Propriétés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/tagsimport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Importer des Tags / Thésaurus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/propsexport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exporter des Propriétés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manipuler les Images à partir de leurs Propriétés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          <label class="md-nav__link" for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    La Similarité
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    La Similarité
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/clusters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les Clusters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/similar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les Images Similaires
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/reco/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les Recommandations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/text/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    La Similarité Textuelle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Approfondir
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Approfondir
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/import/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comprendre l'import des images
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/instances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comprendre les instances
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Projets
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Projets
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/projectimport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Partager un projet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/projectparams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paramétrer un projet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Gérer ses tags
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Gérer ses tags
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Types de tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/tagsmodal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modal des tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/onglets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Les onglets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/astuces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Astuces et raccourcis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Choisir son modèle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Plugins
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../add/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ajouter des plugins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Créer ses plugins
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Créer ses plugins
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#apercu" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aperçu
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aperçu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-ca-marche" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comment ça marche
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chargement-et-cycle-de-vie-des-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chargement et cycle de vie des plugins
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composants-principaux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Composants principaux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ressources-des-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ressources des plugins
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration du plugin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration du plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classe-de-base" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classe de base
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attributs-disponibles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributs disponibles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methodes-disponibles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Méthodes disponibles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametres-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Paramètres du plugin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-de-fonctions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création de fonctions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actionresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        ActionResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ActionResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groupes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notifications
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enregistrement-des-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enregistrement des actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evenements-systeme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Événements système
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Données
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecriture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Écriture
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calcul-lourd-et-concurrence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calcul lourd et concurrence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calcul lourd et concurrence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assistant-asynchrone" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assistant asynchrone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-file-dattente-des-taches" class="md-nav__link">
    <span class="md-ellipsis">
      
        La file d'attente des tâches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-dune-tache" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création d'une tâche
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajout-de-taches-a-la-file-dattente" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ajout de tâches à la file d'attente
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemple-etape-par-etape" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exemple étape par étape
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemple étape par étape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dossier" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dossier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialisation-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialisation du plugin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-de-vecteurs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création de vecteurs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clustering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clustering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../list/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugins existants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Méthodologies proposées
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Méthodologies proposées
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../method/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../method/clusters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Créer des clusters pour identifier des tendances
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../method/duplicates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Identifier des doublons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../method/noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Débruiter son corpus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../method/workspaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gérer ses espaces de travail
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Comparaison de modèles
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Comparaison de modèles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compare/intro.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compare/clip.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLIP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cas d'Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cas d'Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/bnf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Images d'archive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/insta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instagram
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/memes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/movies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Films
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usecases/bd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Personnages de BD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossaire
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ressources Utiles
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#apercu" class="md-nav__link">
    <span class="md-ellipsis">
      
        Aperçu
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aperçu">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-ca-marche" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comment ça marche
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#chargement-et-cycle-de-vie-des-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chargement et cycle de vie des plugins
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composants-principaux" class="md-nav__link">
    <span class="md-ellipsis">
      
        Composants principaux
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ressources-des-plugins" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ressources des plugins
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration du plugin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration du plugin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classe-de-base" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classe de base
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attributs-disponibles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributs disponibles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methodes-disponibles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Méthodes disponibles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametres-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Paramètres du plugin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-de-fonctions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création de fonctions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#actionresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        ActionResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ActionResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Groupes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        Notifications
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enregistrement-des-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enregistrement des actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evenements-systeme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Événements système
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Données
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ecriture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Écriture
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calcul-lourd-et-concurrence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calcul lourd et concurrence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calcul lourd et concurrence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assistant-asynchrone" class="md-nav__link">
    <span class="md-ellipsis">
      
        Assistant asynchrone
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-file-dattente-des-taches" class="md-nav__link">
    <span class="md-ellipsis">
      
        La file d'attente des tâches
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-dune-tache" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création d'une tâche
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajout-de-taches-a-la-file-dattente" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ajout de tâches à la file d'attente
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemple-etape-par-etape" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exemple étape par étape
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemple étape par étape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dossier" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dossier
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#initialisation-du-plugin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialisation du plugin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-de-vecteurs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Création de vecteurs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clustering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clustering
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Créer ses plugins</h1>

<h2 id="apercu">Aperçu</h2>
<p>Panoptic implémente un système de plugins qui vous permet de personnaliser votre façon de travailler avec vos données d'images. L'interface peut s'adapter à divers résultats d'action, ce qui en fait un outil pratique pour la visualisation et la manipulation de données.</p>
<hr />
<h3 id="comment-ca-marche">Comment ça marche</h3>
<p>Les plugins étendent Panoptic en s'intégrant à plusieurs niveaux :</p>
<ul>
<li><strong>Actions de l'interface utilisateur</strong> – Enregistrez des actions personnalisées qui apparaissent dans l'interface et opèrent sur les images sélectionnées.</li>
<li><strong>Événements système</strong> – Répondez à des événements tels que l'importation d'images ou la suppression de dossiers pour automatiser les mises à jour de données.</li>
<li><strong>Couche de données</strong> – Définissez des propriétés personnalisées, stockez des vecteurs et gérez des structures de données dans la base de données du projet.</li>
</ul>
<p>Les fonctionnalités d'apprentissage automatique de Panoptic — vecteurs CLIP, clustering FAISS, recherche par similarité et détection de doublons — sont implémentées dans le plugin <strong>PanopticML</strong> :
<a href="https://github.com/CERES-Sorbonne/PanopticML">https://github.com/CERES-Sorbonne/PanopticML</a></p>
<p>Il constitue un bon exemple pour comprendre comment développer votre propre plugin.</p>
<hr />
<h3 id="chargement-et-cycle-de-vie-des-plugins">Chargement et cycle de vie des plugins</h3>
<p>Les plugins sont chargés au niveau du projet, ce qui signifie que chaque projet Panoptic peut avoir son propre ensemble de plugins actifs avec des configurations spécifiques au projet. Lorsqu'un projet s'ouvre, ses plugins sont initialisés et restent actifs pendant toute la durée de vie du projet.
Un plugin est identifié par un nom unique.</p>
<hr />
<h3 id="composants-principaux">Composants principaux</h3>
<p><strong>PluginProjectInterface</strong> : L'interface principale que les plugins utilisent pour interagir avec le projet Panoptic. Elle donne accès à :</p>
<ul>
<li>Opérations de base de données (instances, propriétés, tags, vecteurs)</li>
<li>Gestion des tâches pour les opérations de longue durée</li>
<li>Système d'événements pour réagir aux changements du projet</li>
<li>Déclencheurs de mise à jour de l'interface utilisateur</li>
</ul>
<p><strong>APlugin</strong> : La classe de base dont tous les plugins doivent hériter. Elle gère :</p>
<ul>
<li>L'enregistrement des actions pour l'intégration à l'interface utilisateur</li>
<li>La gestion des abonnements aux événements</li>
<li>L'accès aux ressources spécifiques du plugin</li>
</ul>
<hr />
<h3 id="ressources-des-plugins">Ressources des plugins</h3>
<p>Chaque plugin a accès à :</p>
<ul>
<li><strong>Dossier de données</strong> : Un répertoire dédié pour stocker les données spécifiques au plugin, les modèles, les caches ou tout fichier persistant dont le plugin a besoin.</li>
<li><strong>Interface de projet</strong> : Accès complet aux données et opérations du projet via <code>PluginProjectInterface</code>.</li>
<li><strong>Chemin de base</strong> : Le répertoire racine du projet pour accéder aux fichiers du projet.</li>
</ul>
<hr />
<h2 id="configuration-du-plugin">Configuration du plugin</h2>
<p>Avant qu'un plugin puisse interagir avec un projet Panoptic, il doit être correctement initialisé et enregistré.
Cette section explique comment définir la classe du plugin, configurer ses paramètres et enregistrer des actions ou des événements afin qu'il s'intègre de manière transparente dans l'environnement Panoptic.</p>
<hr />
<h3 id="classe-de-base">Classe de base</h3>
<p>Chaque plugin hérite de <code>APlugin</code> et est instancié avec trois paramètres :</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MonPlugin</span><span class="p">(</span><span class="n">APlugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">:</span> <span class="n">Project</span><span class="p">,</span> <span class="n">plugin_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">plugin_path</span><span class="o">=</span><span class="n">plugin_path</span><span class="p">)</span>
        <span class="c1"># Initialisez votre plugin ici</span>
</code></pre></div>
<ul>
<li><code>project</code> : Le projet Panoptic chargé.</li>
<li><code>plugin_path</code> : Le chemin du système de fichiers où se trouve votre plugin.</li>
<li><code>name</code> : L'identifiant unique de votre plugin.</li>
</ul>
<p>Pour éviter de bloquer le thread de l'application, vous pouvez exécuter des charges de travail lourdes en surchargeant la fonction asynchrone <code>_start()</code>.
<code>_start()</code> est appelée automatiquement lors du chargement du plugin.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Charger les modèles, créer les propriétés initiales, etc.</span>
</code></pre></div>
<hr />
<h3 id="attributs-disponibles">Attributs disponibles</h3>
<table>
<thead>
<tr>
<th>Attribut</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>L'identifiant du plugin, fourni par l'utilisateur lors de son enregistrement dans Panoptic.</td>
</tr>
<tr>
<td><code>params</code></td>
<td><code>Any</code></td>
<td>Objet <code>params</code> personnalisable qui offre un stockage persistant pour les paramètres du plugin. Ceux-ci peuvent être mis à jour depuis l'interface utilisateur.</td>
</tr>
<tr>
<td><code>path</code></td>
<td><code>str</code></td>
<td>Chemin du système de fichiers vers le répertoire du plugin.</td>
</tr>
<tr>
<td><code>data_path</code></td>
<td><code>Path</code></td>
<td>Chemin vers le dossier de données personnel du plugin. Le dossier est automatiquement supprimé lors de la suppression du plugin.</td>
</tr>
<tr>
<td><code>project</code></td>
<td><code>PluginProjectInterface</code></td>
<td>Interface principale pour interagir avec le projet en cours. Donne accès aux méthodes du projet et aux opérations de base de données.</td>
</tr>
<tr>
<td><code>_project</code></td>
<td><code>Project</code></td>
<td><strong>Attention :</strong> L'objet projet réel donné à l'initialisation. À n'utiliser qu'en cas de nécessité. Les mises à jour de l'interface utilisateur ne sont pas garanties pour les modifications directes.</td>
</tr>
<tr>
<td><code>registered_functions</code></td>
<td><code>List[FunctionDescription]</code></td>
<td>Liste des actions actuellement enregistrées par ce plugin.</td>
</tr>
<tr>
<td><code>vector_types</code></td>
<td><code>list[VectorType]</code></td>
<td>Types de vecteurs enregistrés par votre plugin, mis à jour automatiquement lors de leur modification.</td>
</tr>
<tr>
<td><code>base_key</code></td>
<td><code>str</code></td>
<td>Clé de base de données unique utilisée pour stocker les paramètres du plugin (<code>&lt;nom_plugin&gt;.base</code>).</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="methodes-disponibles">Méthodes disponibles</h3>
<table>
<thead>
<tr>
<th>Méthode</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>def add_action(self, function, description)</code></td>
<td>Méthode</td>
<td>Enregistre manuellement une action personnalisée en fournissant une <code>FunctionDescription</code>.</td>
</tr>
<tr>
<td><code>def add_action_easy(self, function, hooks: list[str] = None)</code></td>
<td>Méthode</td>
<td>Enregistre rapidement une fonction asynchrone en tant qu'action. Vous pouvez spécifier où l'action apparaît dans l'interface utilisateur en définissant les <em>hooks</em>. <br>Valeurs possibles : <code>'vector_type'</code>, <code>'vector'</code>, <code>'similar'</code>, <code>'group'</code>, <code>'execute'</code></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="parametres-du-plugin">Paramètres du plugin</h3>
<p>Les paramètres de plugin permettent aux utilisateurs de configurer le comportement d'un plugin sans modifier son code.
Définissez les paramètres de votre plugin en créant un <code>BaseModel</code> Pydantic. Ces paramètres peuvent être ajustés via l'interface utilisateur et sont automatiquement conservés dans la base de données.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MesParamsPlugin</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="c1"># Drapeaux booléens</span>
    <span class="n">auto_process_imports</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Paramètres numériques</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">confidence_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span>

    <span class="c1"># Options de chaîne de caractères</span>
    <span class="n">output_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;json&quot;</span>
</code></pre></div>
<p>Pour chaque type, l'interface utilisateur affiche un champ de saisie adapté :</p>
<ul>
<li><code>int</code> : Champ numérique</li>
<li><code>float</code> : Champ numérique avec décimales</li>
<li><code>str</code> : Champ de texte</li>
<li><code>bool</code> : Case à cocher</li>
<li><code>PropertyId</code> : Sélection de propriété</li>
<li><code>Enum</code> : Champ de sélection</li>
<li><code>VectorType</code> : Sélection de n'importe quel vecteur enregistré</li>
<li><code>OwnVectorType</code> : Sélection de vecteur enregistré par le plugin lui-même</li>
</ul>
<p>Initialisez les paramètres dans le <code>__init__</code> de votre plugin :</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MonPlugin</span><span class="p">(</span><span class="n">APlugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">project</span><span class="p">:</span> <span class="n">PluginProjectInterface</span><span class="p">,</span> 
        <span class="n">plugin_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">plugin_path</span><span class="o">=</span><span class="n">plugin_path</span><span class="p">)</span>

        <span class="c1"># Initialiser avec les valeurs par défaut</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">MesParamsPlugin</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="creation-de-fonctions">Création de fonctions</h3>
<p>Les fonctions de plugin sont des méthodes asynchrones qui effectuent des opérations sur les données du projet. Elles reçoivent un <code>ActionContext</code> et peuvent également déclarer des entrées supplémentaires :</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ma_fonction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ActionContext</span><span class="p">,</span> <span class="n">param1</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

    <span class="c1"># Obtenir les instances sélectionnées par l&#39;utilisateur</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">instance_ids</span><span class="p">)</span>

    <span class="c1"># Traiter les données</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">process_data</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">param1</span><span class="p">)</span>

    <span class="c1"># Retourner les résultats</span>
    <span class="k">return</span> <span class="n">ActionResult</span><span class="p">(</span>
        <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="n">results</span><span class="p">],</span>
        <span class="n">notifs</span><span class="o">=</span><span class="p">[</span><span class="n">Notif</span><span class="p">(</span><span class="n">NotifType</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s2">&quot;Succès&quot;</span><span class="p">,</span> <span class="s2">&quot;Traitement terminé&quot;</span><span class="p">)]</span>
    <span class="p">)</span>
</code></pre></div>
<p><code>ActionContext</code> est défini comme suit :</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">ActionContext</span><span class="p">:</span>  
    <span class="n">instance_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  
</code></pre></div>
Les valeurs reflètent le contexte actuel de l'interface utilisateur dans lequel l'action a été appelée. Utilisez <code>instance_ids</code> pour savoir sur quelles instances appliquer l'action.</p>
<p>Des paramètres supplémentaires peuvent être définis tant qu'ils sont l'un des types pris en charge :
<code>int, float, str, bool, PropertyId, Enum, VectorType, OwnVectorType</code></p>
<p>Une fonction de plugin valide doit retourner un <code>ActionResult</code> :</p>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">ActionResult</span><span class="p">:</span>  
    <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">notifs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Notif</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
<ul>
<li><code>groups</code> : Groupes d'images à afficher dans l'interface utilisateur.</li>
<li><code>notifs</code> : Notifications (<code>INFO</code>, <code>ERROR</code>, <code>WARNING</code>).</li>
<li><code>value</code> : Espace réservé pour les résultats à valeur unique.</li>
</ul>
<hr />
<h3 id="actionresult">ActionResult</h3>
<p>L'objet <code>ActionResult</code> sert de type de retour unifié pour les actions des plugins.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">ActionResult</span><span class="p">:</span>  
    <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Group</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">notifs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Notif</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
<h4 id="groupes">Groupes</h4>
<p>Lorsqu'elles sont appelées depuis les vues d'instances, les actions <code>group</code>, <code>similar</code> et <code>execute</code> peuvent montrer des groupes d'instances à l'utilisateur en remplissant le champ <code>groups</code>.</p>
<p>Un <code>Group</code> est défini comme suit :
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">Group</span><span class="p">:</span>  
    <span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">sha1s</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="c1"># scores des ids ou sha1s  </span>
    <span class="n">scores</span><span class="p">:</span> <span class="n">ScoreList</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="c1"># score du groupe  </span>
    <span class="n">score</span><span class="p">:</span> <span class="n">Score</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></p>
<p>Vous pouvez peupler le groupe avec des <code>instances</code> ou des <code>images</code> en remplissant les champs <code>ids (instances)</code> ou <code>sha1s (images)</code>. Remplir les deux champs ne doit pas être fait et donnera des résultats inattendus dans l'interface utilisateur.</p>
<p>Les groupes et les instances/images peuvent avoir un score.
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">Score</span><span class="p">:</span>  
    <span class="n">value</span><span class="p">:</span> <span class="nb">float</span>  
    <span class="nb">min</span><span class="p">:</span> <span class="nb">float</span>  
    <span class="nb">max</span><span class="p">:</span> <span class="nb">float</span>  
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  
    <span class="n">max_is_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></p>
<p>Définir les champs <code>min</code>/<code>max</code> permet à l'interface utilisateur d'afficher des options de filtrage adaptées. Le champ <code>max_is_best</code> est utilisé pour inverser le sens du tri. Le champ <code>description</code> donne des informations à l'utilisateur sur l'interprétation de ce score.</p>
<p>Pour noter les instances/images, remplissez le champ <code>scores</code> avec une <code>ScoreList</code> :
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>  
<span class="k">class</span><span class="w"> </span><span class="nc">ScoreList</span><span class="p">:</span>  
    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>  
    <span class="nb">min</span><span class="p">:</span> <span class="nb">float</span>  
    <span class="nb">max</span><span class="p">:</span> <span class="nb">float</span>  
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>  
    <span class="n">max_is_best</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
La seule différence est que le champ <code>value</code> est maintenant un tableau. Les valeurs doivent être dans le même ordre que les <code>ids</code> ou <code>sha1s</code>.</p>
<p>Vous pouvez également donner un nom personnalisé à votre groupe à afficher avec <code>name</code>.
Si aucun nom n'est défini, un nom par défaut sera donné.</p>
<hr />
<h4 id="notifications">Notifications</h4>
<p>Une action peut retourner des notifications pour l'utilisateur.
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Notif</span><span class="p">:</span>  
    <span class="nb">type</span><span class="p">:</span> <span class="n">NotifType</span>  
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">data</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="n">functions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NotifFunction</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  

<span class="k">class</span><span class="w"> </span><span class="nc">NotifType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>  
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="s2">&quot;debug&quot;</span>  
    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span>  
    <span class="n">WARNING</span> <span class="o">=</span> <span class="s2">&quot;warning&quot;</span>  
    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NotifFunction</span><span class="p">:</span>  
    <span class="n">function</span><span class="p">:</span> <span class="nb">str</span>  
    <span class="n">context</span><span class="p">:</span> <span class="n">ActionContext</span>
    <span class="n">message</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></p>
<ul>
<li><code>type</code> : type de notification pour le filtrage</li>
<li><code>name</code> : nom de la notification à afficher</li>
<li><code>message</code> : message de la notification</li>
<li><code>data</code> : Toutes données affichées en JSON dans l'interface utilisateur</li>
<li><code>functions</code> : Suggestion d'actions à afficher dans l'interface utilisateur.</li>
</ul>
<p>Le champ <code>NotifFunction.function</code> attend l'identifiant de chaîne de la fonction. Vous pouvez l'obtenir en sauvegardant la description de la fonction lors de l'enregistrement des actions, comme indiqué dans la section suivante.</p>
<div class="highlight"><pre><span></span><code><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_action_easy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ma_fonction</span><span class="p">,</span> <span class="n">hooks</span><span class="p">)</span>
<span class="n">description</span><span class="o">.</span><span class="n">id</span> <span class="c1"># contient l&#39;identifiant de chaîne de la fonction</span>
</code></pre></div>
<hr />
<h3 id="enregistrement-des-actions">Enregistrement des actions</h3>
<p>Les fonctions peuvent être enregistrées dans le constructeur du plugin <code>__init__()</code>. Deux fonctions sont disponibles pour ce faire :
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_action_easy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">function</span><span class="p">:</span> <span class="n">AsyncCallable</span><span class="p">,</span> 
    <span class="n">hooks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FunctionDescription</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_action</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">function</span><span class="p">:</span> <span class="n">AsyncCallable</span><span class="p">,</span> 
    <span class="n">description</span><span class="p">:</span> <span class="n">FunctionDescription</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FunctionDescription</span>
</code></pre></div>
La fonction <code>add_action_easy()</code> analyse automatiquement la signature de la fonction donnée et la documentation en ligne pour générer une <code>FunctionDescription</code>. Le tableau <code>hooks</code> définit où dans l'interface utilisateur la fonction doit être rendue disponible.
Les <em>hooks</em> actuels sont :
- <code>'vector_type'</code> : Actions de création de type de vecteur
- <code>'vector'</code> : Actions de calcul de vecteur
- <code>'similar'</code> : Actions de recherche de similarité
- <code>'group'</code> : Actions de clustering et de regroupement
- <code>'execute'</code> : Actions d'exécution générales</p>
<p>La <code>FunctionDescription</code> donne à l'interface utilisateur toutes les informations nécessaires pour créer un élément d'interface adapté aux entrées des fonctions. Les paramètres ont des étiquettes, des descriptions et des champs de saisie personnalisables.
Pour plus de contrôle sur l'interface utilisateur, vous pouvez remplir vous-même l'objet <code>FunctionDescription</code> et enregistrer la fonction avec <code>add_action()</code>.</p>
<hr />
<h3 id="evenements-systeme">Événements système</h3>
<p>Les plugins peuvent également écouter des événements pour réagir en conséquence :</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">on_instance_import</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Instance</span><span class="p">],</span> 
    <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">on_folder_delete</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">DeleteFolderConfirm</span><span class="p">],</span>
    <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>
<span class="p">)</span>
</code></pre></div>
<p>Par exemple, le plugin <code>PanopticML</code> utilise l'événement d'importation d'instance pour calculer automatiquement les vecteurs d'image et l'événement de suppression de dossier pour mettre à jour ses index de vecteurs FAISS.</p>
<hr />
<h2 id="donnees">Données</h2>
<p>Les plugins ont souvent besoin de lire et d'écrire des données de projet.
Cette section détaille comment accéder aux instances, aux tags et aux vecteurs depuis la base de données, et comment valider en toute sécurité les modifications tout en gardant l'interface utilisateur synchronisée avec l'état du projet.</p>
<hr />
<h3 id="lecture">Lecture</h3>
<p>L'interface du plugin fournit des méthodes pour interroger divers types de données de la base de données du projet.</p>
<p>La première étape consiste généralement à récupérer plus d'informations sur les instances à partir de <code>ActionContext</code> :</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtenir des instances par ID</span>
<span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="c1"># Obtenir des instances par hachages SHA1</span>
<span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(</span><span class="n">sha1s</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;abc123...&quot;</span><span class="p">,</span> <span class="s2">&quot;def456...&quot;</span><span class="p">])</span>
<span class="c1"># Obtenir toutes les instances (sans filtres)</span>
<span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()</span>
</code></pre></div>
<p>Pour chaque type de données dans Panoptic, l'interface donne accès aux requêtes de base de données correspondantes :</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dossiers</span>
<span class="n">get_folders</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Folder</span><span class="p">]</span>

<span class="c1"># Propriétés</span>
<span class="n">get_properties</span><span class="p">(</span><span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">computed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Property</span><span class="p">]</span>

<span class="c1"># Tags</span>
<span class="n">get_tags</span><span class="p">(</span><span class="n">ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">property_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tag</span><span class="p">]</span>

<span class="c1"># Valeurs de propriété d&#39;instance</span>
<span class="n">get_instance_property_values</span><span class="p">(</span>
    <span class="n">property_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">instance_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PropertyValue</span><span class="p">]</span>

<span class="c1"># Valeurs de propriété d&#39;image</span>
<span class="n">get_image_property_values</span><span class="p">(</span>
    <span class="n">property_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">sha1s</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">PropertyValue</span><span class="p">]</span>

<span class="c1"># Vecteurs</span>
<span class="n">get_vectors</span><span class="p">(</span><span class="n">type_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sha1s</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vector</span><span class="p">]</span>
<span class="n">vector_exist</span><span class="p">(</span><span class="n">type_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sha1</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>

<span class="c1"># Types de vecteurs</span>
<span class="n">get_vector_types</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">VectorType</span><span class="p">]</span>
</code></pre></div>
<p>Plusieurs options de filtrage sont traitées comme des conditions <strong>OU</strong>.</p>
<hr />
<h3 id="ecriture">Écriture</h3>
<p>L'écriture dans la base de données du projet se fait principalement avec le <strong>système de commit</strong>.
Les types suivants prennent en charge la fonctionnalité d'annulation/rétablissement et la synchronisation automatique de l'interface utilisateur lors de l'utilisation de commits :</p>
<p><code>folders</code>, <code>instances</code>, <code>properties</code>, <code>property_groups</code>, <code>tags</code>, <code>instance_values</code> et <code>image_values</code>.</p>
<p>Un objet de commit contient un lot de mises à jour :</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DbCommit</span><span class="p">:</span>  
    <span class="n">empty_instances</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">empty_property_groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">empty_properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">empty_tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">empty_instance_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InstancePropertyKey</span><span class="p">]</span>
    <span class="n">empty_image_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ImagePropertyKey</span><span class="p">]</span>

    <span class="n">folders</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Folder</span><span class="p">]</span> 
    <span class="n">instances</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span>
    <span class="n">property_groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">PropertyGroup</span><span class="p">]</span>
    <span class="n">properties</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Property</span><span class="p">]</span>
    <span class="n">tags</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tag</span><span class="p">]</span>  
    <span class="n">instance_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">InstanceProperty</span><span class="p">]</span>
    <span class="n">image_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ImageProperty</span><span class="p">]</span>

    <span class="n">timestamp</span><span class="p">:</span> <span class="n">datetime</span>
</code></pre></div>
<p>Pour supprimer des objets, marquez-les dans les listes <code>empty_</code> correspondantes.</p>
<p>Certains objets ont un ID unique de type <code>int</code>. Lors de la création de nouveaux objets, vous devez définir un ID négatif. Des fonctions d'assistance sont fournies pour garantir une attribution d'ID correcte :</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_instance</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">folder_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">extension</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">sha1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">ahash</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Instance</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_property</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">type_</span><span class="p">:</span> <span class="n">PropertyType</span><span class="p">,</span> 
    <span class="n">mode</span><span class="p">:</span> <span class="n">PropertyMode</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Property</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_property_group</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PropertyGroup</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_tag</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">property_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">parent_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">color</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tag</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_vector_type</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> 
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VectorType</span>
</code></pre></div>
<p>Les ID négatifs sont valides à l'intérieur d'un commit et peuvent être référencés par d'autres nouveaux objets.
Par exemple, une <code>InstanceValue</code> peut référencer à la fois une nouvelle instance et une nouvelle propriété avec des ID négatifs.
Lors de l'écriture dans la base de données, Panoptic détermine automatiquement l'ordre d'insertion correct et met à jour les ID une fois les objets stockés.</p>
<p>Exécutez un commit à l'aide de l'une des méthodes suivantes :</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">apply_commit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commit</span><span class="p">:</span> <span class="n">DbCommit</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">do</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">commit</span><span class="p">:</span> <span class="n">DbCommit</span><span class="p">)</span>
</code></pre></div>
<p>La fonction <code>do()</code> calcule le commit opposé avant d'appeler <code>apply_commit()</code>, permettant à l'opération d'être inversée plus tard avec <code>undo()</code>.</p>
<p>Deux types d'objets ne sont <strong>pas</strong> écrits via des commits : <code>vector_type</code> et <code>vector</code>.
Utilisez plutôt les méthodes correspondantes :</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_vector_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">VectorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VectorType</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span>
</code></pre></div>
<hr />
<h2 id="calcul-lourd-et-concurrence">Calcul lourd et concurrence</h2>
<p>Le backend de Panoptic s'exécute dans une boucle d'événements asynchrone. Pour éviter de bloquer le thread principal, les charges de travail lourdes doivent être exécutées dans un <code>ThreadPoolExecutor</code>.
Il existe deux manières principales de le faire dans Panoptic.</p>
<hr />
<h3 id="assistant-asynchrone">Assistant asynchrone</h3>
<p>Le moyen le plus simple de déléguer une fonction bloquante à l'exécuteur est d'utiliser l'assistant :</p>
<div class="highlight"><pre><span></span><code><span class="n">res</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</code></pre></div>
<p>Utilisez cet assistant pour les tâches d'arrière-plan simples qui n'ont pas besoin d'être suivies ou visualisées dans l'interface utilisateur.
Il est idéal pour les opérations légères où vous avez juste besoin de décharger une fonction bloquante sur un thread d'arrière-plan et d'attendre le résultat de manière asynchrone.</p>
<p>Les exemples incluent :</p>
<ul>
<li>Exécuter de petites transformations de données</li>
<li>Effectuer des opérations d'E/S de fichiers légères</li>
<li>Appeler une fois une fonction de bibliothèque bloquante</li>
</ul>
<hr />
<h3 id="la-file-dattente-des-taches">La file d'attente des tâches</h3>
<p>La <code>TaskQueue</code> est conçue pour gérer et suivre les tâches d'arrière-plan.
Chaque tâche peut inclure une séquence de fonctions asynchrones ou synchrones traitées comme une seule unité de travail.</p>
<p>Son principal avantage est de fournir un <strong>retour visuel dans l'interface utilisateur</strong> via une barre de progression.
De plus, il prend en charge l'exécution de fonctions spécifiques une fois qu'un ensemble de tâches est terminé.</p>
<hr />
<h3 id="creation-dune-tache">Création d'une tâche</h3>
<p>Héritez de la classe de base <code>Task</code> et implémentez la méthode <code>run()</code> :</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">panoptic.core.task.task</span><span class="w"> </span><span class="kn">import</span> <span class="n">Task</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MaTacheDeTraitement</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plugin</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">priority</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Mettez priority=True pour les tâches urgentes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plugin</span> <span class="o">=</span> <span class="n">plugin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instance</span> <span class="o">=</span> <span class="n">instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

        <span class="c1"># Personnaliser l&#39;identification de la tâche</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Traiter l&#39;</span><span class="n">image</span><span class="s1">&#39;  # Montré dans l&#39;</span><span class="n">interface</span> <span class="n">utilisateur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;task_1&#39;</span>  <span class="c1"># Identifiant unique</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Exécution principale de la tâche - s&#39;exécute en arrière-plan&quot;&quot;&quot;</span>
        <span class="c1"># Utiliser _async() pour les opérations gourmandes en CPU</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_calcul_lourd</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span>
        <span class="p">)</span>

        <span class="c1"># Stocker les résultats (les opérations de base de données sont déjà asynchrones)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">add_vector</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_if_last</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Appelé une fois que toutes les tâches avec cette clé sont terminées&quot;&quot;&quot;</span>
        <span class="c1"># Reconstruire les index, mettre à jour l&#39;interface utilisateur ou effectuer un nettoyage</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">plugin</span><span class="o">.</span><span class="n">rebuild_index</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_calcul_lourd</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Le travail gourmand en CPU s&#39;exécute dans le thread de l&#39;exécuteur&quot;&quot;&quot;</span>
        <span class="c1"># Charger et traiter l&#39;image</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span>

        <span class="c1"># Effectuer un calcul lourd</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="n">extract_vectors</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">vectors</span>
</code></pre></div>
<p>Le champ <code>self.key</code> a deux objectifs :</p>
<ul>
<li>Exécute la fonction <code>run_if_last()</code> sur la dernière tâche avec la même clé.</li>
<li>Regroupe les tâches associées dans l'interface utilisateur.</li>
</ul>
<hr />
<h3 id="ajout-de-taches-a-la-file-dattente">Ajout de tâches à la file d'attente</h3>
<p>Ajoutez des tâches depuis votre plugin à l'aide de l'interface de projet :</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">:</span> <span class="n">Task</span><span class="p">):</span>
</code></pre></div>
<p>La barre des tâches devrait maintenant être visible dans l'interface utilisateur.</p>
<h2 id="exemple-etape-par-etape">Exemple étape par étape</h2>
<p>Ce guide vous montrera comment créer un nouveau plugin étape par étape. Notre objectif est d'ajouter des fonctions personnalisées à Panoptic :
- <code>compute_vectors()</code> : une fonction qui calcule les vecteurs d'image
- <code>compute_clusters()</code> : une fonction qui calcule des clusters pour une liste d'instances</p>
<p>Pour que ce soit très simple, nous implémenterons une fonction qui calcule les vecteurs d'une sélection d'instances avec le <em>hook</em> <code>execute</code>. Et une fonction de clustering avec le <em>hook</em> <code>group</code>. Nous n'aurons qu'un seul type de vecteur par défaut.</p>
<hr />
<h3 id="dossier">Dossier</h3>
<p>Un plugin est contenu dans un dossier que nous appellerons <code>mon_plugin</code>.
À l'intérieur de ce dossier, nous créons trois fichiers : <code>__init__.py</code>, <code>mon_plugin.py</code> et <code>requirements.txt</code>.</p>
<div class="highlight"><pre><span></span><code>mon_plugin
| __init__.py
| mon_plugin.py
| requirements.txt
</code></pre></div>
<ul>
<li><code>__init__.py</code> est le point d'entrée pour le chargeur de plugins.</li>
<li><code>requirements.txt</code> contient les dépendances de modules pip pour le plugin. Dans notre cas, il sera vide.</li>
<li><code>mon_plugin.py</code> contient le code du plugin.</li>
</ul>
<h3 id="initialisation-du-plugin">Initialisation du plugin</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># mon_plugin.py</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">panoptic.core.plugin.plugin</span><span class="w"> </span><span class="kn">import</span> <span class="n">APlugin</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">panoptic.core.project.project</span><span class="w"> </span><span class="kn">import</span> <span class="n">Project</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">panoptic.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActionContext</span>  
<span class="kn">from</span><span class="w"> </span><span class="nn">panoptic.models.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ActionResult</span>  


<span class="k">class</span><span class="w"> </span><span class="nc">MonPlugin</span><span class="p">(</span><span class="n">APlugin</span><span class="p">):</span>  
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">:</span> <span class="n">Project</span><span class="p">,</span> <span class="n">plugin_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>  
<span class="w">        </span><span class="sd">&quot;&quot;&quot;  </span>
<span class="sd">        La méthode d&#39;initialisation pour un plugin Panoptic. </span>
<span class="sd">        Est appelée par Panoptic au lancement du projet.        </span>
<span class="sd">        :param project: L&#39;instance du projet        </span>
<span class="sd">        :param plugin_path: Le chemin vers le module du plugin        </span>
<span class="sd">        :param name: L&#39;identifiant du plugin en tant que nom unique</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="c1"># n&#39;oubliez pas d&#39;appeler le constructeur parent  </span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span> <span class="n">plugin_path</span><span class="o">=</span><span class="n">plugin_path</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action_easy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_vectors</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;vector&#39;</span><span class="p">])</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">add_action_easy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_clusters</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">])</span>  

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">compute_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ActionContext</span><span class="p">):</span>  
        <span class="n">res</span> <span class="o">=</span> <span class="n">ActionResult</span><span class="p">()</span>  
        <span class="c1"># du code ...  </span>
        <span class="k">return</span> <span class="n">res</span>  

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">compute_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ActionContext</span><span class="p">,</span> <span class="n">nb_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  
        <span class="n">res</span> <span class="o">=</span> <span class="n">ActionResult</span><span class="p">()</span>  
        <span class="c1"># du code ...  </span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div>
<p>Cet extrait de code définit notre classe de plugin. Il est important d'appeler le constructeur parent dans notre propre fonction <code>__init__(..)</code> pour initialiser correctement le plugin.
Nous pouvons ensuite enregistrer notre fonction et sélectionner nos <em>hooks</em> d'action. La fonction <code>compute_vectors()</code> est enregistrée en tant qu'action <code>vector</code> et la fonction <code>compute_clusters()</code> en tant qu'action <code>group</code>.</p>
<p>Le corps de la fonction est vide pour l'instant, mais pour s'assurer que l'interface utilisateur est satisfaite, nous retournons déjà un <code>ActionResult</code>.</p>
<hr />
<div class="highlight"><pre><span></span><code><span class="c1"># __init__.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mon_plugin</span><span class="w"> </span><span class="kn">import</span> <span class="n">MonPlugin</span>  

<span class="n">plugin_class</span> <span class="o">=</span> <span class="n">MonPlugin</span>
</code></pre></div>
<p>Enfin, nous déclarons la <code>plugin_class</code> dans le fichier <code>__init__.py</code>.</p>
<p>Vous pouvez maintenant démarrer Panoptic et ajouter votre plugin. Vous devriez voir votre fonction de clustering sur le <code>ActionButton</code> de <code>group</code>.</p>
<p><img alt="Bouton Cluster" src="../../images/plugin/ClusterButton.png" /></p>
<p>Comme vous pouvez le voir, notre fonction de calcul de vecteur n'est pas visible dans l'interface utilisateur. C'est parce que nous n'avons enregistré aucun <code>vector_type</code> pour notre plugin. Les types de vecteurs servent d'identifiant pour les vecteurs.</p>
<p><img alt="Paramètres de vecteur vides" src="../../images/plugin/EmptyVectorSettings.png" /></p>
<h3 id="creation-de-vecteurs">Création de vecteurs</h3>
<p>Pour stocker des vecteurs dans la base de données, nous devons enregistrer un <code>vector_type</code> pour eux.
Pour cet exemple, nous n'aurons qu'un seul type pour nos vecteurs factices.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_types</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  
        <span class="n">vec_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">create_vector_type</span><span class="p">({</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;fake_vector&quot;</span><span class="p">})</span>  
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">add_vector_type</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)</span>  
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;créé &#39;</span><span class="p">,</span> <span class="n">vec_type</span><span class="p">)</span>
</code></pre></div>
<p>Nous implémentons la fonction <code>_start()</code>, qui est automatiquement appelée lors du chargement du plugin.
La variable <code>self.vector_types</code> est automatiquement mise à jour avec les types de vecteurs créés par ce plugin. Si la liste est vide, nous voulons en créer un.
Comme d'autres objets, les types de vecteurs ont un ID entier unique géré par la base de données. Vous pouvez créer un nouveau type de vecteur à l'aide de la fonction utilitaire :
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">create_vector_type</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span>
</code></pre></div>
Ensuite, nous ajoutons le type de vecteur à la base de données avec
<div class="highlight"><pre><span></span><code><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">add_vector_type</span><span class="p">(</span><span class="n">vec_type</span><span class="p">)</span> 
</code></pre></div></p>
<p><code>self.vec_type</code> contient maintenant notre nouveau type de vecteur, et il est visible dans l'interface utilisateur.</p>
<p><img alt="Paramètres de vecteur" src="../../images/plugin/VectorSettings.png" />
Et notre fonction de calcul de vecteur est maintenant appelable en cliquant sur le bouton <code>compute</code> dans la ligne du vecteur.</p>
<hr />
<p>Nous voulons placer les images dans un espace vectoriel à 1 dimension où la valeur représente la teinte principale (0-255) de l'image.
Notre fonction de calcul ressemble à ceci :
<div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">compute_hue_vector</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>  
    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>  
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>  
    <span class="n">img_hsv</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;HSV&#39;</span><span class="p">)</span>  

    <span class="c1"># Obtenir les données HSV en tant que tableau numpy  </span>
    <span class="n">hsv_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img_hsv</span><span class="p">)</span>  

    <span class="c1"># Extraire le canal de teinte (premier canal en HSV)  </span>
    <span class="n">hue_channel</span> <span class="o">=</span> <span class="n">hsv_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>  

    <span class="c1"># Aplatir et calculer l&#39;histogramme  </span>
    <span class="n">hue_flat</span> <span class="o">=</span> <span class="n">hue_channel</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  

    <span class="c1"># Obtenir la valeur de teinte la plus courante  </span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">hue_flat</span><span class="p">)</span>  
    <span class="n">dominant_hue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>  

    <span class="c1"># Vecteur à 1 dimension. Convertir en float32 pour correspondre au type de la base de données</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dominant_hue</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>et notre fonction <code>compute_vectors()</code> mise à jour</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">compute_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ActionContext</span><span class="p">):</span>  
    <span class="c1"># obtenir les instances de la base de données  </span>
    <span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">instance_ids</span><span class="p">)</span>  
    <span class="c1"># ne garder qu&#39;une seule instance par sha1  </span>
    <span class="n">unique</span> <span class="o">=</span> <span class="nb">list</span><span class="p">({</span><span class="n">i</span><span class="o">.</span><span class="n">sha1</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">}</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>  
    <span class="c1"># obtenir notre id de type de vecteur  </span>
    <span class="n">type_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span>  

    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">:</span>  
        <span class="c1"># calculer le vecteur de teinte dans l&#39;exécuteur pour éviter de bloquer </span>
        <span class="c1"># le thread principal  </span>
        <span class="n">hue_vector</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">run_async</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_hue_vector</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">url</span>
        <span class="p">)</span>  
        <span class="c1"># créer l&#39;objet vecteur à écrire dans la base de données  </span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="n">type_id</span><span class="o">=</span><span class="n">type_id</span><span class="p">,</span> <span class="n">sha1</span><span class="o">=</span><span class="n">instance</span><span class="o">.</span><span class="n">sha1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">hue_vector</span><span class="p">)</span>  
        <span class="c1"># écrire dans la base de données  </span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">add_vector</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>  

    <span class="c1"># envoyer une notification de succès  </span>
    <span class="n">notif</span> <span class="o">=</span> <span class="n">Notif</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">NotifType</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> 
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;compute_vectors&#39;</span><span class="p">,</span> 
        <span class="n">message</span><span class="o">=</span><span class="s1">&#39;Tous les vecteurs ont été calculés&#39;</span>
    <span class="p">)</span>  
    <span class="c1"># toujours retourner un ActionResult  </span>
    <span class="k">return</span> <span class="n">ActionResult</span><span class="p">(</span><span class="n">notifs</span><span class="o">=</span><span class="p">[</span><span class="n">notif</span><span class="p">])</span>
</code></pre></div>
<p>Il est important d'envelopper les fonctions gourmandes en calcul avec la fonction <code>run_async</code>.
Encore mieux, vous pouvez utiliser les interfaces <code>Task</code> et <code>TaskQueue</code> pour exécuter des calculs en arrière-plan.
Vous pouvez vous référer au plugin officiel <strong>PanopticML</strong> pour un exemple qui utilise un objet <code>Task</code>.</p>
<p>À la fin, nous retournons une notification pour indiquer que le calcul s'est terminé avec succès.
Cette notification apparaîtra dans l'interface utilisateur une fois l'action terminée.</p>
<p><img alt="Notification d'information" src="../../images/plugin/InfoNotif.png" />
Si votre fonction plante sans gestion d'erreur appropriée, Panoptic générera automatiquement une notification d'erreur qui inclut la stacktrace.</p>
<p><img alt="Notification d'erreur" src="../../images/plugin/ErrorNotif.png" /></p>
<hr />
<h3 id="clustering">Clustering</h3>
<p>Maintenant que nous avons des vecteurs, nous pouvons commencer le clustering. Pour notre exemple, nous allons trier les images par valeur de teinte, puis créer un nombre choisi de groupes de taille égale.</p>
<p>Le calcul ressemble à ceci :
<div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>  
<span class="k">def</span><span class="w"> </span><span class="nf">group_instances_by_hue</span><span class="p">(</span>
    <span class="n">instances</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Instance</span><span class="p">],</span> 
    <span class="n">sha1_to_hue</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> 
    <span class="n">num_groups</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">):</span>  
<span class="w">    </span><span class="sd">&quot;&quot;&quot;  </span>
<span class="sd">    Trier les instances par teinte et les regrouper.    </span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="c1"># Utiliser np pour la simplicité</span>
    <span class="n">id_array</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">])</span>  
    <span class="n">hue_array</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sha1_to_hue</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">sha1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">])</span>  

    <span class="c1"># Trier par teinte  </span>
    <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">hue_array</span><span class="p">)</span>  
    <span class="n">sorted_ids</span> <span class="o">=</span> <span class="n">id_array</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>  
    <span class="n">sorted_hue</span> <span class="o">=</span> <span class="n">hue_array</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>  

    <span class="c1"># Diviser en groupes de taille égale  </span>
    <span class="n">id_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">sorted_ids</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">)</span>  
    <span class="n">hue_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">sorted_hue</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">id_groups</span><span class="p">,</span> <span class="n">hue_groups</span>
</code></pre></div></p>
<p>Nous devons intégrer ce résultat dans l'API <code>ActionResult</code>.
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">compute_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">ActionContext</span><span class="p">,</span> <span class="n">nb_clusters</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>  
    <span class="c1"># obtenir les instances de la base de données  </span>
    <span class="n">instances</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">ctx</span><span class="o">.</span><span class="n">instance_ids</span><span class="p">)</span>  
    <span class="c1"># obtenir nos propres vecteurs de la base de données  </span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">get_vectors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>  
    <span class="c1"># mapper sha1 à la teinte avec les données du vecteur  </span>
    <span class="n">sha1_to_hue</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="o">.</span><span class="n">sha1</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">}</span>  
    <span class="c1"># calculer les vecteurs avec les données  </span>
    <span class="n">id_groups</span><span class="p">,</span> <span class="n">hue_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_instances_by_hue</span><span class="p">(</span>
        <span class="n">instances</span><span class="p">,</span> <span class="n">sha1_to_hue</span><span class="p">,</span> <span class="n">nb_clusters</span>
    <span class="p">)</span>  

    <span class="c1"># itérer sur le résultat et remplir les objets Group  </span>
    <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="k">for</span> <span class="n">id_group</span><span class="p">,</span> <span class="n">hue_group</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">id_groups</span><span class="p">,</span> <span class="n">hue_groups</span><span class="p">):</span>  
        <span class="c1"># obtenir la teinte min et max de chaque groupe  </span>
        <span class="n">min_hue</span> <span class="o">=</span> <span class="n">hue_group</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>  
        <span class="n">max_hue</span> <span class="o">=</span> <span class="n">hue_group</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>  
        <span class="c1"># créer un groupe d&#39;ID d&#39;instance  </span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">Group</span><span class="p">(</span>
            <span class="c1"># extraire les ID d&#39;instance du tableau np.array</span>
            <span class="n">ids</span><span class="o">=</span><span class="n">id_group</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> 
            <span class="c1"># choisir un nom pour le groupe</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Groupe de teintes : </span><span class="si">{</span><span class="n">min_hue</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">max_hue</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>  
        <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>  

    <span class="c1"># retourner les clusters  </span>
    <span class="k">return</span> <span class="n">ActionResult</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span>
</code></pre></div></p>
<p>L'implémentation de <code>compute_vectors</code> est facile à suivre. D'abord, nous récupérons toutes les données nécessaires pour calculer notre clustering, puis nous utilisons <code>ActionResult</code> pour retourner les groupes à l'interface utilisateur.</p>
<p><img alt="Résultat du clustering par teinte" src="../../images/plugin/ClusteringHueResult.png" /></p>
<p>Appelez la fonction depuis l'<code>ActionButton</code> "Créer des clusters" et le résultat devrait être visible dans l'interface utilisateur. Assurez-vous d'avoir exécuté l'action de calcul de vecteur auparavant.</p>
<p>Nous espérons que ce guide a pu rendre la logique derrière le système de plugins plus compréhensible. Le plugin officiel <strong>PanopticML</strong> est la meilleure ressource pour avoir des exemples plus complexes d'utilisation de plugins.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pied de page" >
        
          
          <a href="../add/" class="md-footer__link md-footer__link--prev" aria-label="Précédent: Ajouter des plugins">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Précédent
              </span>
              <div class="md-ellipsis">
                Ajouter des plugins
              </div>
            </div>
          </a>
        
        
          
          <a href="../list/" class="md-footer__link md-footer__link--next" aria-label="Suivant: Plugins existants">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Suivant
              </span>
              <div class="md-ellipsis">
                Plugins existants
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>